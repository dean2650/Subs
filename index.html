<!DOCTYPE html>
<html>
<head>
    <title>Dean Demo</title>

    <link rel="stylesheet" type="text/css" href="StyleSheetHTML.css" />

    <script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
    <script type="text/javascript" src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>
    <script type="text/javascript" src="http://www.pureexample.com/js/lib/jquery.ui.touch-punch.min.js"></script>

    <link href="https://fonts.googleapis.com/css?family=Droid+Sans+Mono" rel="stylesheet">

    <meta name="viewport" content="width=device-width,height=device-height,user-scalable=yes">
</head>
<body style="width: 100%; height: 100%; overflow: hidden; font-family: Tahoma; color: #892E2E; font-size: small">

    <form id="form1">
        <script>

            function custom_compare(a, b) {
                return a[1] - b[1];
            }

            $(function () {

                var mTop = 0;

                $('.draggable').draggable({

                    zIndex: 9700,

                    revert: 'invalid', opacity: 0.65,

                    stop: function (event, ui) {

                        // Make it properly draggable again
                        $(this).draggable('option', 'revert', 'invalid');
                    }

                });

                $('.droppable').droppable({

                    hoverClass: "drop-hover",

                    drop: function (event, ui) {
                        var $this = $(this);

                        if (event.target.id == "ZoneOff") {

                            //remove class from ON
                            ui.draggable.context.children[2].children[0].className = "";

                            //Add class To OFF
                            ui.draggable.context.children[3].children[0].className = "OFF";

                        }

                        if (event.target.id == "ZoneAway") {

                            //remove class from ON
                            ui.draggable.context.children[2].children[0].className = "";

                            //Add class To OFF
                            ui.draggable.context.children[3].children[0].className = "";

                        }

                        if (event.target.id == "ZoneOn") {

                            // Check number of elements already in
                            if ($this.find('.draggable').length >= 4) {
                                // Cancel drag operation (make it always revert)
                                ui.draggable.draggable('option', 'revert', true);

                                return;
                            }

                            //assign class name to ON
                            ui.draggable.context.children[2].children[0].className = "ON";

                            //remove class from OFF
                            ui.draggable.context.children[3].children[0].className = "";

                        }

                        if (event.target.id == "ZoneGoal") {

                            // Check number of elements already in
                            if ($this.find('.draggable').length >= 1) {
                                // Cancel drag operation (make it always revert)
                                ui.draggable.draggable('option', 'revert', true);

                                return;
                            }

                            //assign class name to ON
                            ui.draggable.context.children[2].children[0].className = "ON";

                            //remove class from OFF
                            ui.draggable.context.children[3].children[0].className = "";

                        }

                        var aa = ui.draggable.context;
                        if (event.target.id == "ZoneGoal")
                            aa.style.backgroundColor = "#84C5E8"
                        if (event.target.id == "ZoneOn")
                            aa.style.backgroundColor = "limegreen"
                        if (event.target.id == "ZoneOff")
                            aa.style.backgroundColor = "orangered"
                        if (event.target.id == "ZoneAway")
                            aa.style.backgroundColor = "#F0F0F0"

                        // Put dragged item into container
                        ui.draggable.appendTo($this).css({
                            top: '0px',
                            left: '0px'
                        });

                        //if we are dragging out of zoneON, then (in the each loop) change bg
                        $('.droppable').each(function () {

                            var $this = $(this);

                            if ($this.context.id == "ZoneOn") {
                                if ($this.find('.draggable').length >= 4) {
                                    $this.context.style.backgroundColor = "silver"
                                }
                                else {
                                    $this.context.style.backgroundColor = "white"
                                }
                            }

                        });

                        //check if goal and ON is set, if so, enable START button, else disable
                        var ons = document.getElementsByClassName("ON");

                        var start = document.getElementById("btnStartMatch");
                        var subs = document.getElementById("btnResetSubs");
                        if (ons.length == 5) {
                            start.disabled = ""
                            subs.disabled = ""
                        }
                        else {
                            start.disabled = "disabled"
                            subs.disabled = "disabled"
                        }

ã€€
                    }
                });

            });
        </script>
        <div class="divShadow2" style="border: 0px solid #C2DBEF; background-color: #EAF0F7; padding: 20px; height: 840px; width: 1280px; margin-left: auto; margin-right: auto; text-align: center; box-sizing: border-box">

            <div style="float: left;">

                <div id="head" style="border-color: dodgerblue; height: 220px; width: 1235px;">

                    <div class="divShadow2" style="height: 210px; width: 320px; padding: 10px; background-color: white; float: left">
                        <table style="width: 100%; text-align: left; color: #3D72AD;">
                            <tr>
                                <td style="width: 83px">Always On</td>
                                <td>&nbsp;</td>
                            </tr>
                            <tr>
                                <td style="width: 83px">Away</td>
                                <td>&nbsp;</td>
                            </tr>
                            <tr>
                                <td style="width: 83px">Sub Changes</td>
                                <td>&nbsp;</td>
                            </tr>
                        </table>
                        <br />
                        <textarea id="TextArea1" name="S1" style="width: 306px; height: 78px"></textarea><br />
                        <br />
                        <input id="btnResetMatch" disabled="disabled" type="button" value="Reset" style="width: 95px; height: 28px;" onclick="SwapMatchTime();" />
                    </div>

                    <div id="spacer" style="height: 230px; width: 40px; float: left">
                    </div>

                    <div class="divShadow2" style="height: 230px; width: 280px; background-color: white; float: left">
                        <div style="position: relative; top: -10px">
                            <label id="lblHome" style="font-size: 56pt; font-family: 'Droid Sans Mono'; color: limegreen">0</label>
                            <label id="lblSep" style="font-size: 56pt; font-family: 'Droid Sans Mono'; color: black">:</label>
                            <label id="lblAway" style="font-size: 56pt; font-family: 'Droid Sans Mono'; color: firebrick">0</label>

                        </div>
                        <div style="position:relative; top:-10px;">
                            <select id="Select1" name="D1" style="width: 230px">
                                <option value="volvo">Aaaaa</option>
                                <option value="saab">Bbbb</option>
                                <option value="mercedes">Cccccc</option>
                                <option value="audi">Dddddd</option>
                            </select>

                        </div>

                        <table style="width: 100%">
                            <tr>
                                <td></td>
                            </tr>
                            <tr>
                                <td>
                                    <input id="btnResetMatch0" disabled="disabled" type="button" value="+ 1" style="width: 70px; height: 32px; font-size: 24px; color: #2BAA2B;" /></td>
                                <td>
                                    <input id="btnResetMatch2" disabled="disabled" type="button" value="+ 1" style="width: 70px; height: 32px; font-size: 24px; color: firebrick;" /></td>
                            </tr>
                            <tr>
                                <td>&nbsp;</td>
                                <td>&nbsp;</td>
                            </tr>
                            <tr>
                                <td>
                                    <input id="btnResetMatch1" disabled="disabled" type="button" value="- 1" style="width: 70px; height: 24px; font-size: 16px; color: #2BAA2B;" /></td>
                                <td>
                                    <input id="btnResetMatch3" disabled="disabled" type="button" value="- 1" style="width: 70px; height: 24px; font-size: 16px; color: firebrick;" /></td>
                            </tr>
                        </table>
                    </div>

                    <div id="Workarea" class="divShadow2" style="width: 520px; height: 230px; float: right; background-color: white; text-align: left; padding-left: 10px; padding-right: 10px;">
                        <table style="width: 100%; height: 82px; padding: 0px; margin: 0px;">
                            <tr>
                                <td style="width: 221px">
                                    <label id="lblTime" style="font-size: 56pt; font-family: 'Droid Sans Mono'; color: dodgerblue">00:00</label>
                                </td>
                                <td></td>
                                <td style="text-align: left; width: 193px;">
                                    <label id="lblTimeLeft" style="font-size: 56pt; font-family: 'Droid Sans Mono'; color: rebeccapurple">00:00</label>
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 221px">
                                    <label id="lblx" style="font-size: 10pt; color: dodgerblue">Game Time</label></td>
                                </td>
                                <td>&nbsp;</td>
                                <td style="text-align: left; width: 193px;">
                                    <label id="lblx1" style="font-size: 10pt; color: rebeccapurple">Subs Time</label></td>
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 221px">
                                    <br />
                                </td>
                                <td>&nbsp;</td>
                                <td style="text-align: left; width: 193px;">&nbsp;</td>
                            </tr>
                        </table>
                        <table style="width: 100%">
                            <tr>
                                <td>
                                    <input id="btnStartMatch" disabled="disabled" type="button" value="Start" style="width: 223px; height: 34px;" onclick="SwapMatchTime();" /></td>
                                <td>&nbsp;</td>
                                <td>&nbsp;</td>
                                <td style="text-align: right">
                                    <input id="btnResetSubs" disabled="disabled" type="button" value="Reset Subs Timer" style="width: 223px; height: 34px;" onclick="ResetTime();" /></td>
                            </tr>
                        </table>
                    </div>

                </div>
                <br />

ã€€
                <br />

                <div id="ZoneOn" class="droppable" style="border-color: forestgreen;">
                </div>
                <br />

                <div id="head1" style="height: 130px; width: 1235px;">

                    <div id="ZoneGoal" class="droppable" style="border-color: dodgerblue; height: 120px; float: left; top: 100px; width: 155px;">
                    </div>

                    <div id="ZoneOff" class="droppable" style="border-color: orangered; width: 1000px; float: right">
                    </div>

                </div>

                <br />

                <div id="ZoneAway" class="droppable" style="border-color: gray; height: 240px">

                    <div id="div3" class="draggable">
                        <div class="Header">
                            <label id="Header1">Aaaaa</label>
                        </div>
                        <div style="float: left">
                            <img id="Image1" src="Assets/a.png">
                        </div>
                        <div class="TimerOn">
                            <label id="lblOn1" class="">0</label>
                        </div>
                        <div class="TimerOff">
                            <label id="lblOff1" class="">0</label>
                        </div>
                    </div>

                    <div id="div4" class="draggable">
                        <div class="Header">
                            <label id="Header2">Bbbbb</label>
                        </div>
                        <div style="float: left">
                            <img id="Image2" src="Assets/b.png">
                        </div>
                        <div class="TimerOn">
                            <label id="lblOn2" class="">0</label>
                        </div>
                        <div class="TimerOff">
                            <label id="lblOff2" class="">0</label>
                        </div>
                    </div>

                    <div id="div5" class="draggable">
                        <div class="Header">
                            <label id="Header3">Ccccc</label>
                        </div>
                        <div style="float: left">
                            <img id="Image3" src="Assets/c.png">
                        </div>
                        <div class="TimerOn">
                            <label id="lblOn3" class="">0</label>
                        </div>
                        <div class="TimerOff">
                            <label id="lblOff3" class="">0</label>
                        </div>
                    </div>

                    <div id="div6" class="draggable">
                        <div class="Header">
                            <label id="Header4">Ddddd</label>
                        </div>
                        <div style="float: left">
                            <img id="Image4" src="Assets/d.png">
                        </div>
                        <div class="TimerOn">
                            <label id="lblOn4" class="">0</label>
                        </div>
                        <div class="TimerOff">
                            <label id="lblOff4" class="">0</label>
                        </div>
                    </div>

                    <div id="div7" class="draggable">
                        <div class="Header">
                            <label id="Header5">Eeeee</label>
                        </div>
                        <div style="float: left">
                            <img id="Image5" src="Assets/e.png">
                        </div>
                        <div class="TimerOn">
                            <label id="lblOn5" class="">0</label>
                        </div>
                        <div class="TimerOff">
                            <label id="lblOff5" class="">0</label>
                        </div>
                    </div>

                    <div id="div8" class="draggable">
                        <div class="Header">
                            <label id="Header6">Fffff</label>
                        </div>
                        <div style="float: left">
                            <img id="Image6" src="Assets/f.png">
                        </div>
                        <div class="TimerOn">
                            <label id="lblOn6" class="">0</label>
                        </div>
                        <div class="TimerOff">
                            <label id="lblOff6" class="">0</label>
                        </div>
                    </div>

                    <div id="div9" class="draggable">
                        <div class="Header">
                            <label id="Header7">Gggggg</label>
                        </div>
                        <div style="float: left">
                            <img id="Image7" src="Assets/g.png">
                        </div>
                        <div class="TimerOn">
                            <label id="lblOn7" class="">0</label>
                        </div>
                        <div class="TimerOff">
                            <label id="lblOff7" class="">0</label>
                        </div>
                    </div>

                    <div id="div10" class="draggable">
                        <div class="Header">
                            <label id="Header8">Hhhhhh</label>
                        </div>
                        <div style="float: left">
                            <img id="Image8" src="Assets/h.png">
                        </div>
                        <div class="TimerOn">
                            <label id="lblOn8" class="">0</label>
                        </div>
                        <div class="TimerOff">
                            <label id="lblOff8" class="">0</label>
                        </div>
                    </div>

                    <div id="div11" class="draggable">
                        <div class="Header">
                            <label id="Header11">Jjjjj</label>
                        </div>
                        <div style="float: left">
                            <img id="Image11" src="Assets/j.png">
                        </div>
                        <div class="TimerOn">
                            <label id="lblOn11" class="">0</label>
                        </div>
                        <div class="TimerOff">
                            <label id="lblOff11" class="">0</label>
                        </div>
                    </div>

                </div>

            </div>

        </div>

    </form>

    <script type="text/javascript">

        var mCtr = 0;
        var mSubsTime = 300;
        var inYellow;

        function FixTimes(mTime) {
            var totalSeconds = Math.abs(mTime);

            var seconds = Math.floor(totalSeconds % 60);
            var minutes = Math.floor(totalSeconds / 60);

            if (mTime <= 0) {
                return "-" + checkTime(minutes) + ":" + checkTime(seconds);
            }
            else {
                return checkTime(minutes) + ":" + checkTime(seconds);
            }

        }

        function checkTime(i) {
            return (i > -10 && i < 10) ? "0" + i : i;
        }

        function ResetTime() {
            mSubsTime = 300;
            inYellow = false;

            var zoneOn = document.getElementById("ZoneOn");
            zoneOn.style.backgroundColor = "silver";
        }

ã€€
        function SwapMatchTime(sender, args) {

            var dd = document.getElementById("btnStartMatch");

            if (dd.value == "Pause Match") {
                dd.value = "Continue Match";
                //stop subs timer
                //SwapTime();
            }
            else {
                dd.value = "Pause Match";
                //SwapTime();
            }

        }

ã€€
        function HighlightYellow() {
            var ActualNbrSubs;

            //find the top xx to take off
            var ons = document.getElementsByClassName("ON");
            var foo = [];
            for (var i = ons.length - 1; i >= 0; i--) {

                var mDiv = document.getElementById(ons[i].id).parentElement.parentElement;

                //don't include if in goal
                if (mDiv.parentElement.id == "ZoneOn") {
                    //don't include if we are AlwaysOn
                    if (mDiv.style.backgroundColor != "rgb(166, 191, 230)") {
                        foo.push([mDiv, parseInt(ons[i].innerText)]);
                    }
                }
            }
            //sort in descending order
            var xx = foo.sort(custom_compare).reverse();

            var NbrSubs = document.getElementsByClassName("OFF").length;

            //if we have less ON than NbrSubs, then recalculate
            if (NbrSubs > xx.length)
                ActualNbrSubs = xx.length;
            else
                ActualNbrSubs = NbrSubs;

            //get top xx to come OFF
            for (var i = 0; i <= ActualNbrSubs - 1; i++) {
                var mOff = xx[i][0];

                if (mOff.parentElement.id == "ZoneOn") {
                    mOff.style.backgroundColor = "yellow";
                }
            }

            //find top xx to put back ON
            var offs = document.getElementsByClassName("OFF");
            var foo = [];
            for (var i = offs.length - 1; i >= 0; i--) {

                var mDiv = document.getElementById(offs[i].id).parentElement.parentElement;

                foo.push([mDiv, parseInt(offs[i].innerText)]);

            }
            //sort in descending order
            var xx = foo.sort(custom_compare).reverse();

            //put the same number OFF back ON
            var offs = document.getElementsByClassName("OFF");

            for (var i = 0; i <= ActualNbrSubs - 1; i++) {

                var mOff = xx[i][0];
                mOff.style.backgroundColor = "yellow";

            }

        }

ã€€
        (function () {

            function startTime() {

                var btn = document.getElementById("btnStartMatch");

                var ons = document.getElementsByClassName("ON");
                var offs = document.getElementsByClassName("OFF");

                //have we started the match...
                if (btn.value == "Pause Match") {

                    //update match time
                    mCtr = mCtr + 1;
                    lblTime.innerText = FixTimes(mCtr);

                    mSubsTime = mSubsTime - 1;
                    lblTimeLeft.innerText = FixTimes(mSubsTime);

                    //UPDATE TIMES ON each dock
                    for (var i = ons.length - 1; i >= 0; i--) {

                        var ctr = parseInt(ons[i].innerText);
                        ons[i].innerHTML = ctr + 1;
                    }

                    for (var i = offs.length - 1; i >= 0; i--) {

                        var ctr = parseInt(offs[i].innerText);
                        offs[i].innerHTML = ctr + 1;
                    }

                    //check if we are due for a subs change
                    if (mSubsTime <= 280 && !inYellow) {

                        inYellow = true;

                        HighlightYellow();

                    }

                    if (mSubsTime <= 270) {

                        var zoneOn = document.getElementById("ZoneOn");

                        //flash screen so we remember to RESET
                        if (zoneOn.style.backgroundColor == "silver")
                            zoneOn.style.backgroundColor = "red";
                        else
                            zoneOn.style.backgroundColor = "silver";
                    }

                }

                t = setTimeout(function () {
                    startTime()
                }, 1000);
            }
            startTime();
        })();

    </script>

</body>
</html>
